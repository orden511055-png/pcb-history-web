<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>My Web Excel</title>

  <!-- Handsontable -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/handsontable@13.0.0/dist/handsontable.full.min.css">
  <script src="https://cdn.jsdelivr.net/npm/handsontable@13.0.0/dist/handsontable.full.min.js"></script>

  <!-- SheetJS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <style>
    body { font-family: Arial; padding:20px; }
    #hot { width:100%; height:500px; }
    button { margin-right:10px; }
  </style>
</head>
<body>

<h2>üåê My Web Excel</h2>

<input type="file" id="upload" />
<button onclick="exportExcel()">ÂåØÂá∫ Excel</button>

<br><br>

<div id="hot"></div>

<script>
const container = document.getElementById('hot');

const hot = new Handsontable(container, {
  data: Handsontable.helper.createSpreadsheetData(20, 10),
  rowHeaders: true,
  colHeaders: true,
  licenseKey: 'non-commercial-and-evaluation',
  dropdownMenu: true,
  filters: true,
  columnSorting: true,
  formulas: {
    engine: HyperFormula
  }
});

// ÂåØÂÖ• Excel
document.getElementById('upload').addEventListener('change', function(e) {
    const reader = new FileReader();
    reader.onload = function(event) {
        const data = new Uint8Array(event.target.result);
        const workbook = XLSX.read(data, {type: 'array'});
        const sheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[sheetName];
        const json = XLSX.utils.sheet_to_json(worksheet, {header:1});
        hot.loadData(json);
    };
    reader.readAsArrayBuffer(e.target.files[0]);
});

// ÂåØÂá∫ Excel
function exportExcel() {
    const data = hot.getData();
    const ws = XLSX.utils.aoa_to_sheet(data);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
    XLSX.writeFile(wb, "export.xlsx");
}
</script>

</body>
</html>
